platform :ios do
  lane :update_version do
    package = load_json(json_path: File.join(Dir.pwd, "../", "package.json"))

    increment_build_number(
      xcodeproj: File.join(Dir.pwd, "../ios", ENV["IOS_XCODE_PROJ"]),
      build_number: ENV['BUILD_NUMBER'] || 1
    )

    increment_version_number(
      xcodeproj: File.join(Dir.pwd, "../ios", ENV["IOS_XCODE_PROJ"]),
      version_number: package['version']
    )
  end
end

platform :android do
  lane :update_version do
    package = load_json(json_path: File.join(Dir.pwd, "../", "package.json"))

    increment_version_code(
      gradle_file_path: "./android/app/build.gradle",
      version_code: ENV['BUILD_NUMBER'] || 1
    )

    increment_version_name(
      gradle_file_path: "./android/app/build.gradle",
      version_name: package['version']
    )
  end
end
